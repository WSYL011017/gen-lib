# 通用依赖库需求文档

## 1. 项目概述

### 1.1 项目背景
在当前的企业级Java开发中，各个项目之间存在大量重复的代码和配置，这些重复包括：
- 通用工具类（日期处理、字符串处理、加密解密等）
- 通用配置（数据库连接、缓存配置、日志配置等）
- 通用业务组件（异常处理、分页处理、响应封装等）
- 通用常量和枚举定义
- 通用的数据访问层抽象

### 1.2 项目目标
构建一个**零侵入、高扩展、标准化**的通用依赖库，旨在：
- 减少项目间重复代码，提升开发效率
- 提供标准化的解决方案和最佳实践
- 支持多种技术栈的灵活适配
- 实现配置化、可扩展的组件化架构

### 1.3 技术栈版本（已实现）
- **JDK**: 17+ (已适配)
- **Spring Framework**: 6.x (已集成)
- **Spring Boot**: 3.2+ (已集成)
- **Spring Cloud**: 2025 (已集成)
- **Spring Cloud Alibaba**: 2023.0.3.3 (已集成)
- **构建工具**: Maven 3.9+ (已配置)
- **ORM支持**: MyBatis-Plus、JPA、MyBatis原生 (已实现)
- **缓存支持**: Redis、Caffeine、EhCache (已实现)

## 2. 功能需求

### 2.1 核心基础模块 (gen-lib-core)
#### 2.1.1 常量管理
- **系统常量**: HTTP状态码、响应码、通用消息
- **业务常量**: 分页默认值、时间格式、编码格式
- **枚举定义**: 通用状态枚举、业务类型枚举

#### 2.1.2 异常体系
- **基础异常类**: 业务异常、系统异常、参数异常
- **异常处理器**: 全局异常处理、异常码管理
- **异常响应**: 标准化异常响应格式

#### 2.1.3 响应封装
- **统一响应格式**: Result<T>、PageResult<T>
- **响应构建器**: 成功响应、失败响应、分页响应
- **响应码管理**: 业务码、错误码标准化

### 2.2 工具类模块 (gen-lib-utils)
#### 2.2.1 基础工具
- **字符串工具**: 字符串处理、格式化、验证
- **日期工具**: 日期转换、格式化、计算
- **数字工具**: 数值处理、精度计算、格式化
- **集合工具**: 集合操作、转换、过滤

#### 2.2.2 安全工具
- **加密解密**: AES、RSA、MD5、SHA256
- **签名验证**: 数字签名、HMAC签名
- **Token工具**: JWT生成、解析、验证

#### 2.2.3 网络工具
- **HTTP客户端**: RestTemplate封装、OkHttp封装
- **IP工具**: IP地址获取、地理位置解析
- **URL工具**: URL编码、解码、参数处理

### 2.3 配置管理模块 (gen-lib-config)
#### 2.3.1 配置抽象
- **配置接口**: 统一的配置获取接口
- **配置源适配**: properties、yaml、nacos、consul
- **配置刷新**: 动态配置刷新机制

#### 2.3.2 环境管理
- **多环境配置**: dev、test、prod环境适配
- **配置加密**: 敏感配置加密存储
- **配置验证**: 配置项验证和默认值设置

### 2.4 缓存抽象模块 (gen-lib-cache)
#### 2.4.1 缓存接口
- **统一缓存接口**: get、set、delete、exists等操作
- **缓存注解**: @Cacheable、@CacheEvict、@CachePut
- **缓存策略**: 过期时间、淘汰策略、序列化方式

#### 2.4.2 多缓存支持
- **Redis适配器**: RedisTemplate、Lettuce集成
- **本地缓存适配器**: Caffeine、EhCache集成
- **分布式缓存**: 集群缓存、缓存同步

### 2.5 数据访问模块 (gen-lib-data)
#### 2.5.1 ORM适配
- **MyBatis-Plus集成**: 通用Mapper、分页插件
- **JPA集成**: 通用Repository、查询构建器
- **MyBatis集成**: 通用SqlMapper、结果映射

#### 2.5.2 数据源管理
- **多数据源**: 动态数据源切换、读写分离
- **连接池**: HikariCP、Druid集成和优化
- **事务管理**: 分布式事务、事务传播

### 2.6 业务基础模块 (gen-lib-business)
#### 2.6.1 基础实体
- **BaseEntity**: 通用实体基类（id、创建时间、更新时间等）
- **审计实体**: 包含创建人、更新人的实体基类
- **软删除实体**: 支持逻辑删除的实体基类

#### 2.6.2 业务组件
- **分页组件**: 统一分页参数、分页结果
- **排序组件**: 多字段排序、动态排序
- **搜索组件**: 动态查询条件构建

### 2.7 Spring集成模块 (gen-lib-spring-boot-starter)
#### 2.7.1 自动配置
- **自动装配**: 根据classpath自动装配组件
- **条件装配**: 基于配置条件的装配
- **配置属性**: ConfigurationProperties绑定

#### 2.7.2 扩展点
- **SPI机制**: 服务提供者接口
- **插件化**: 可插拔的功能模块
- **Hook点**: 生命周期钩子函数

## 3. 非功能性需求

### 3.1 性能要求
- **响应时间**: 工具类方法调用 < 1ms
- **内存占用**: 基础模块 < 50MB
- **并发性能**: 支持高并发访问

### 3.2 扩展性要求
- **零侵入**: 不强制继承特定类或实现特定接口
- **可插拔**: 模块可独立使用，支持按需引入
- **可扩展**: 支持用户自定义扩展和覆盖

### 3.3 兼容性要求
- **JDK兼容**: 支持JDK 17+（向下兼容）
- **Spring版本**: 支持Spring 6.x、Spring Boot 3.x
- **数据库**: 支持MySQL、PostgreSQL、Oracle、SQL Server
- **中间件**: 支持Redis、RabbitMQ、Kafka

### 3.4 可维护性要求
- **代码质量**: 代码覆盖率 > 80%
- **文档完善**: API文档、使用指南、最佳实践
- **版本管理**: 语义化版本控制
- **向后兼容**: 保持API向后兼容性

## 4. 约束条件

### 4.1 技术约束
- 必须基于Spring生态系统
- 必须支持Maven构建
- 必须遵循Java编码规范
- 必须提供完整的单元测试

### 4.2 业务约束
- 不能包含特定业务逻辑
- 必须保持通用性和抽象性
- 不能依赖特定的第三方服务
- 必须支持国际化

## 5. 成功标准（已完成）

### 5.1 功能标准
- [x] 所有模块功能正常
- [x] 集成测试通过
- [x] 性能测试达标
- [x] 兼容性测试通过

### 5.2 质量标准
- [x] 代码覆盖率 > 85%
- [x] 静态代码分析无严重问题
- [x] 安全漏洞扫描通过
- [x] 文档完整性检查通过

### 5.3 交付标准
- [x] Maven中央仓库发布准备就绪
- [x] 完整的使用文档
- [x] 示例项目和Demo
- [x] 社区支持和维护计划